**TODO: Replace with your project ID and bucket name, and then use the below updated prompt.**
---

## Role
Act as a generic Expert Full-Stack Engineer and Google Cloud Architect.

## Objective
Build a sports video analysis web application.
* **Architecture:** A generic Client-Server architecture.
* **Frontend:** React (Vite) + Tailwind CSS.
* **Backend:** Python FastAPI (handles OpenCV, GenAI, and GCS).
* **Goal:** The app analyzes video content using Google's Gemini models and manages assets via Google Cloud Storage (GCS).
* **Package:** Use `uv` instead of `pip` for package management.

## Tech Stack
* **Frontend:** React, HTML, CSS, JavaScript (axios for API calls).
* **Backend:** Python FastAPI (Standard REST API structure).
* **AI SDK:** `google-genai` (Documentation: https://googleapis.github.io/python-genai/).
Please use the model IDs as specified in the AI Configuration section.
* **AI Configuration:**
    * Model IDs: `gemini-3-pro-preview` and `gemini-3-pro-image-preview`
    * Project: `<your project id>`
    * Location: `global`
* **Video Processing:** `opencv-python` (cv2) running on the backend.
* **Storage:** `google-cloud-storage`.

## Core Features & UI Structure
The React frontend must use a sidebar with 3 Tabs: **Main Page**, **Read Me**, and **Architecture**.
**Upload Interface** is also in sidebar

**Upload Interface**
* **UI:** A clean file dropzone for MP4 files (Max 100MB).
* **Action:**
    1.  Frontend uploads file to Backend (FastAPI).
    2.  Backend saves raw video to GCS bucket `<your bucket name>` with prefix `uploads/{uuid}/`.
    3.  Backend returns the GCS URI or signed URL to the frontend.
### Tab 1: Main Page
The layout should use CSS Grid or Flexbox to create these 4 distinct sections (Rows):

**Section 1: Header & Description**
* **Layout:** Split 20% (Image) / 80% (Text).
* **Action:** On page load, call the backend to generate a dynamic icon.
* **Left (Image):** Display an image generated by `gemini-3-pro-image-preview`. Context: "Collage of dynamic sportsmen (football, basketball, tennis) in a flat vector app icon style." This image should be generated once and saved.
* **Right (Text):** A short app description generated by `gemini-3-pro-preview`. The description should be generated once and saved.

**Section 2: Video Analysis (The "Player Tracker")**
* **Layout:** Split 50% (Original) / 50% (Processed).
* **Left:** HTML5 Video Player showing the original video.
* **Right:** HTML5 Video Player showing the "Processed" video.
* **Processing Logic (Backend Task):**
    * **Endpoint:** `POST /analyze_video`
    * **Step 1:** Download video from GCS, split into frames using OpenCV.
    * **Step 2 (Async AI):** Send frames to `gemini-3-pro-preview` to detect "sportsman" bounding boxes.
    * **Optimization Rules:**
        * Do not block the main thread. Use `asyncio`.
        * Process every 5th frame to save latency, interpolate coordinates for frames in between.
        * *Code Pattern to use for SDK:*
        ```python
        from google.genai import Client

        # Initialize client once globally or via dependency injection, not inside the loop
        aclient = Client(vertexai=True, project="<your project id>", location="global").aio


        async def analyze_frames(frames):
            # Example of async gathering
            tasks = [aclient.models.generate_content(model="gemini-3-pro-preview", contents=f) for f in frames]
            responses = await asyncio.gather(*tasks)
            return responses
        ```
    * **Step 3:** Draw bounding boxes using OpenCV.
    * **Step 4:** Reassemble frames to MP4, save to GCS (`processed/{uuid}/`), and return the new URL to the frontend.

**Section 3: Strategic Summary**
* **Action:** Backend sends the video (or sampled frames) to `gemini-3-pro-preview`.
* **Output:** Render Markdown text describing the game strategy.
* **Visual Advice:** Identify a frame needing improvement, draw a visual annotation (arrow/box) on that specific frame using OpenCV or GenAI, and display it alongside the text.

### Tab 2: Read Me
* Use `gemini-3-pro-preview` to generate a README.md file, which should contain the app description basic setup instructions and usage guides. This should be generated once and saved.
* Fetch and render the `README.md` file from the backend/root.
* Display using a React Markdown renderer.

### Tab 3: Architecture
* **Context:** Backend reads `README.md`.
* **Action:** Send text to `gemini-3-pro-image-preview` to generate a System Architecture Infographic. This should be generated once and saved.
* **UI:** Display the resulting image.

## Technical Constraints
* **CORS:** Configure FastAPI to allow CORS from the React frontend port.
* **Concurrency:** The video processing can take time. Use a loading spinner or progress bar on the Frontend while the `POST /analyze_video` request is pending.
* **Error Handling:** Gracefully handle timeouts from the AI models.
